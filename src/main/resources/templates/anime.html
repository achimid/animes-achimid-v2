<!DOCTYPE html>
<html lang="pt-br" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title th:text="|${anime.name} - Animes Achimid|">Anime Page - Animes Achimid</title>

    <meta name="robots" content="max-image-preview:large">
    <meta name="googlebot" content="all">

    <meta name="description" th:content="|Encontre informa√ß√µes de ${anime.name} no Animes Achimid|">
    <meta name="keywords" th:content="|${anime.name}, Anime, Lan√ßamento, Temporada, Fansub, Gr√°tis|">
    <meta property="og:title" th:content="|${anime.name} - AnimesAchimid|">
    <meta property="og:description" th:content="${anime.description}">
    <meta property="og:image" th:content="${anime.imageUrl}">
    <meta property="og:type" content="video.tv_show">
    <meta property="og:locale" content="pt_BR" />
    <meta property="og:site_name" content="Animes Achimid" />

    <link rel="canonical" th:href="|https://animes.achimid.com.br/anime/${anime.slug}|" />

    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">

    <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Righteous&family=Inter:wght@400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" media="all" th:href="@{/css/common.css}" />
    <link rel="stylesheet" type="text/css" media="all" th:href="@{/css/anime.css}" />

    <style th:inline="css">
        .anime-hero {
            position: relative;
            padding: 4rem 5%;
            background: linear-gradient(0deg, var(--bg-dark) 0%, rgba(0, 0, 0, 0.85) 100%),
            url([(${anime.imageBackgroundUrl} ?: ${anime.imageUrl})]);
            background-size: cover;
            background-position: center;
            display: flex;
            gap: 40px;
            align-items: flex-start;
            flex-wrap: wrap;
        }
    </style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-89V9QWJ1Q4"></script>
    <script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-89V9QWJ1Q4');</script>
    <meta name="google-site-verification" content="_TNQ2lXCMgZqsSzlzOXC2PbzOrWopVSYFHmUBen1Q6c" />

    <script th:inline="javascript" type="application/ld+json">
        {"@context": "https://schema.org","@type": "TVSeries","name": [[${anime.name}]],"alternateName": [[${anime.nameSecondary}]],"image": [[${anime.imageUrl}]],"genre": [[${anime.tags}]],"description": [[${anime.description}]],"aggregateRating": {"@type": "AggregateRating","ratingValue": [[${anime.score}]],"bestRating": 10,"worstRating": 1,"ratingCount": 10000}}
    </script>
</head>
<body>
    <header th:replace="~{fragments/layout :: header}"></header>

    <section class="anime-hero">
        <div class="anime-poster">
            <span class="status-badge" th:text="${anime.status}">Anime Status</span>
            <img loading="lazy" th:src="${anime.imageUrl}" th:alt="${anime.name}">
        </div>

        <div class="anime-info-header">
            <h1 th:text="${anime.name}">Anime Title</h1>
            <span class="native-title" th:text="${anime.nameSecondary}">Anime Secondary Title</span>

            <div class="rating">
                ‚òÖ <div th:text="${anime.score}"></div>
                <span>(Rank <span th:text="${anime.rank}"></span> Global no MyAnimeList)</span>
            </div>

            <div class="meta-tags">
                <span class="tag" th:each="tag : ${anime.tags}" th:text="${tag}">Anime Tags</span>
            </div>

            <p style="color: #ccc; max-width: 800px; margin-bottom: 20px;" th:text="${anime.description}"> Anime Description </p>

            <div class="action-container">
                <button class="btn btn-primary">‚ñ∫ Assistir Agora</button>

                <button class="btn btn-secondary" id="fav-btn" th:onclick="toggleFavorite(this, [[${anime.id}]])">+ Minha Lista</button>

                <div class="external-icons">
                    <a href="https://www.crunchyroll.com" target="_blank" title="Assistir no Crunchyroll">
                        <img loading="lazy" src="https://www.google.com/s2/favicons?sz=64&domain=crunchyroll.com" class="ext-icon" alt="CR">
                    </a>
                    <a th:href="|https://myanimelist.net/anime/${anime.id}|" target="_blank" title="Ver no MyAnimeList">
                        <img loading="lazy" src="https://www.google.com/s2/favicons?sz=64&domain=myanimelist.net" class="ext-icon" alt="MAL">
                    </a>
                    <a href="https://anilist.co" target="_blank" title="Ver no AniList">
                        <img loading="lazy" src="https://www.google.com/s2/favicons?sz=64&domain=anilist.co" class="ext-icon" alt="AL">
                    </a>
                </div>
            </div>
        </div>
    </section>

    <main class="content-container">

        <div class="main-column">
            <h2 class="section-title">Sinopse</h2>
            <div class="description" th:utext="${anime.synopsis}"></div>

            <h2 class="section-title">Lista de Epis√≥dios</h2>
            <div class="episodes-list" id="ep-list-dynamic">
                <p class="episodes-disclaimer">
                    <i class="fas fa-info-circle"></i> Pode ser que haja alguma confus√£o de epis√≥dios devido a forma que os sites nomeiam o anime e os epis√≥dios
                </p>
                <div class="description" th:if="${anime.episodes.isEmpty()}">Ainda n√£o encontramos nenhum epis√≥dios desse anime!</div>
                <div class="episode-container" th:each="episode : ${anime.episodes}" >
                    <article>
                        <div class="episode-item" onclick="toggleEpOptions(this)">
                            <div class="ep-info">
                                <span class="ep-num" th:text="|${episode.typeDescription}: ${episode.number}|"></span>
                                <span class="ep-title" th:text="${episode.title}"></span></div>
                            <div class="ep-play-btn">Visualizar ‚ñº</div>
                        </div>
                        <div class="episode-options">
                            <a class="opt-btn" th:each="option : ${episode.options}" th:href="${option.url}" th:text="${option.name}">Option Button</a>
                        </div>
                    </article>
                </div>

                <p class="episodes-disclaimer">
                    <i class="fas fa-info-circle"></i> Com o tempo os sites podem ter sidos desativados
                </p>
            </div>

            <section class="comments-section">
                <h2 class="section-title">Coment√°rios</h2>
                <div class="comment-box">
                    <div class="comment-input-area">
                        <textarea id="txtComment" placeholder="Compartilhe o que voc√™ acha do anime..."></textarea>
                        <button id="btnPublishComment" th:onclick="onClickPublishComment(this, [[${anime.id}]])" class="btn btn-primary" style="align-self: flex-end; padding: 10px 25px;">Publicar</button>
                    </div>

                    <div class="comment-list" id="commentList">
                        <div class="comment-item" th:each="comment : ${anime.comments}">
<!--                            <button class="delete-comment" title="Excluir coment√°rio" onclick="removeComment(this)">üóë</button>-->
                            <div class="comment-avatar" th:text="${comment.avatar}">AH</div>
                            <div class="comment-content">
                                <span class="user-name" th:text="${comment.userName}">User</span>
                                <p class="comment-text" th:text="${comment.content}">Content</p>
                                <span class="comment-date" th:text="${comment.date}">Date</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <aside class="sidebar">
            <div class="sidebar-card">
                <h3 style="color:var(--primary-green); margin-bottom:15px;">Informa√ß√µes</h3>
                <div class="info-row">
                    <span class="info-label">Status:</span>
                    <span class="info-value" th:text="${anime.status}">0</span>
                </div>
                <div class="info-row" th:each="info : ${anime.infoList}">
                    <span class="info-label" th:text="|${info.infoName}:|">Status:</span>
                    <span class="info-value" th:text="${info.infoValue}">Ongoing</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Acessos:</span>
                    <span class="info-value" th:text="${anime.accessCounter}">0</span>
                </div>
            </div>

            <div class="sidebar-card" style="border-color: var(--accent-orange);">
                <h3 style="color:var(--accent-orange); margin-bottom:15px;">Rankings</h3>
                <ul style="font-size: 0.9rem; color: #ccc;">
                    <li style="padding: 5px 0; border-bottom: 1px solid #333;">Score:
                        <span th:text="${anime.score}"></span>
                    </li>
                    <li style="padding: 5px 0; border-bottom: 1px solid #333;">Popularidade:
                        <span th:text="${anime.popularity}"></span>
                    </li>
                    <li style="padding: 5px 0;">Rank:
                        <span th:text="${anime.rank}"></span>
                    </li>
                </ul>
            </div>

            <div class="sidebar-card">
                <h3 style="color:var(--primary-green); margin-bottom:15px;">√öltimos Lan√ßamentos</h3>
                <div class="latest-list">
                    <a th:href="|/anime/${release.animeSlug}|" class="latest-item anime-tooltip-div" th:each="release : ${releases}">
                        <img loading="lazy" th:src="${release.animeImageUrl}" th:alt="${release.animeName}" class="anime-tooltip">
                        <span th:text="${release.animeName}">Anime Release Title</span>
                        <span class="ep-tag" th:text="|${release.animeType}: ${release.animeEpisode}|">Anime Release Number</span>
                    </a>
                </div>
            </div>

            <div class="sidebar-card" style="border-top-color: var(--accent-orange);">
                <h3 style="color:var(--accent-orange); margin-bottom:15px;">Recomendados Aleat√≥riamente</h3>
                <div class="recommended-list">
                    <a href="#" class="rec-item" th:each="recomendation : ${recommendations}" th:href="|/anime/${recomendation.slug}|">
                        <img class="rec-thumb" loading="lazy" th:src="${recomendation.imageUrl}" th:alt="|Poster do anime ${recomendation.title}|">
                        <div class="rec-info">
                            <span class="rec-title" th:text="${recomendation.title}">Anime Recomendation Title</span>
                            <span class="rec-meta" th:text="${recomendation.meta}">Anime Recomendation Tags</span>
                        </div>
                    </a>
                </div>
            </div>
        </aside>

    </main>

    <footer th:replace="~{fragments/layout :: footer}"></footer>

    <script type="text/javascript" th:src="@{/js/common.js}"></script>
    <script type="text/javascript" th:src="@{/js/anime.js}"></script>
</body>
</html>